var q=e=>{throw TypeError(e)};var G=(e,t,o)=>t.has(e)||q("Cannot "+o);var x=(e,t,o)=>(G(e,t,"read from private field"),o?o.call(e):t.get(e)),g=(e,t,o)=>t.has(e)?q("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,o);import{compute as m,State as N,Compute as H,Watcher as I,watcher as W,state as R}from"belling";var n=class{constructor(t,o){this.name=t,this.children=o}style(t){return this._style?Object.assign(this._style,t):this._style=t,this}attr(t){return this._attr?Object.assign(this._attr,t):this._attr=t,this}on(t){return this._events?Object.assign(this._events,t):this._events=t,this}ref(t){return this._ref=t,this}render(t,o=document.createElement(this.name)){var l;let i=o;if(this.dom=i,this._events)for(let r in this._events){let c=this._events[r];r==="unmount"?t._addDestroyCallback(c):i.addEventListener(r,c)}if(this._attr)for(let r in this._attr){let c=this._attr[r];typeof c=="function"?t._watch(m(()=>{i.setAttribute(r,c())})):c instanceof H||c instanceof N?t._watch(m(()=>{i.setAttribute(r,c.v)})):i.setAttribute(r,c)}if(this._style)for(let r in this._style){let c=r,u=this._style[c];typeof u=="function"?t._watch(m(()=>{i.style[c]=u()})):u instanceof H||u instanceof N?t._watch(m(()=>{i.style[c]=u.v})):i.style[c]=u}if(this.children)for(let r of this.children)if(typeof r=="string"){let c=document.createTextNode(r);i.appendChild(c)}else if(typeof r=="function"){let c=document.createTextNode("");t._watch(m(()=>c.nodeValue=r())),i.appendChild(c)}else if(r instanceof N||r instanceof H){let c=document.createTextNode("");t._watch(m(()=>c.nodeValue=r.v)),i.appendChild(c)}else i.appendChild(r.render(t));return(l=this._ref)==null||l.call(this,i),i}},C=new Set,D=new Set,j=!1;function U(){D.forEach(e=>e()),C.forEach(e=>e.v),C.clear(),D.clear(),j=!1}function O(e){j||(j=!0,requestAnimationFrame(U)),typeof e=="function"?D.add(e):C.add(e)}var y,E,_=class{constructor(t,o){g(this,y,new I);g(this,E,[]);this._whenDestroy=[];x(this,y).callback=O,this.dom=o.render(this),t==null||t.appendChild(this.dom)}_watch(t){x(this,E).push(t),x(this,y).watch(t)}_addDestroyCallback(t){this._whenDestroy.push(t)}_destroy(){x(this,y).unwatch(),this._whenDestroy.forEach(t=>t())}};y=new WeakMap,E=new WeakMap;function z(e,t,o){if(o.length=0,t.length=0,e.length<1)return o;function i(u,h){for(let a=t.length;a<u;a++)t.push(-1);t[u]=h}let l=0,r=e.length;for(;l<r&&e[l]==-1;l++);for(o[0]=l;l<r;l++){let u=e[l];if(u==-1)continue;let h=o[o.length-1];if(e[h]<u){i(l,h),o.push(l);continue}let a=0,s=o.length-1,w;for(;a<s;)w=a+s>>1,e[o[w]]<u?a=w+1:s=w;let f=a;u<e[o[f]]&&(f>0&&i(l,o[f-1]),o[f]=l)}l=o.length;let c=o[o.length-1];if(c>e.length)return o;for(;l-- >0;)o[l]=e[c],c=t[c];return o}var V=[],F=[],P=[],K=[],M,T,b=class extends n{constructor(o,i,l){super(o);g(this,M,new Map);g(this,T,new Map);this.list=i,this.f=l}render(o){let i=super.render(o),l=this.list,r=x(this,M),c=this.f,u=x(this,T);function h(){let s=V;s.length=0;let w=l.v;w.forEach(d=>{let p=r.get(d);typeof p=="number"?(r.set(d,-1),s.push(p)):s.push(-1)}),K.length=0;let f=K;i.childNodes.forEach(d=>f.push(d)),r.forEach((d,p)=>{d!=-1&&(u.get(p)._destroy(),u.delete(p),r.delete(p),i.removeChild(f[d]))});let B=z(s,F,P),A=0;w.forEach((d,p)=>{let k=s[p],L=B[A];if(k==-1){let S=new _(void 0,c(d));u.set(d,S),p==w.length-1?i.appendChild(S.dom):i.insertBefore(S.dom,f[L])}else k==L?A++:i.insertBefore(f[k],f[L]);r.set(d,p)}),V.length=0,F.length=0,P.length=0,K.length=0}let a=W(()=>{O(h)});return a.watch(l),o._addDestroyCallback(()=>{a.unwatch(),x(this,T).forEach(s=>s._destroy())}),h(),i}};M=new WeakMap,T=new WeakMap;var v=class extends n{constructor(o){super("div");this.dom=void 0;this._node=o}render(o){let i=this._node;this._ele=i.v;let l=()=>{var c;let r=i.v;if(this._ele=r,this._events=r._events,this._attr=r._attr,this._style=r._style,this._ref=r._ref,this.children=r.children,(c=this._root)==null||c._destroy(),this._root=new _(void 0,r),this.dynDom){let u=this.dynDom.parentNode;u&&u.replaceChild(this._root.dom,this.dynDom)}this.dynDom=r.dom};return this._watcher=W(l),this._watcher.watch(i),l(),o._addDestroyCallback(()=>{var r;(r=this._root)==null||r._destroy(),this._watcher.unwatch()}),this.dynDom}};function $(e,...t){return new n(e,t)}function ee(e,t,o){return new b(e,t,o)}function ne(e,t,o){let i=new WeakMap;return new b(e,m(()=>{let r=t.v;return r.forEach((c,u)=>{let h=i.get(c);h?h.v=u:i.set(c,R(u))}),r}),r=>o(i.get(r),r))}document.createElement("br");function te(e){return typeof e=="function"?new v(m(e)):new v(e)}function re(...e){return new n("address",e)}function oe(...e){return new n("article",e)}function ie(...e){return new n("aside",e)}function ce(...e){return new n("footer",e)}function le(...e){return new n("header",e)}function ue(...e){return new n("h1",e)}function se(...e){return new n("h2",e)}function de(...e){return new n("h3",e)}function he(...e){return new n("h4",e)}function ae(...e){return new n("h5",e)}function fe(...e){return new n("h6",e)}function pe(...e){return new n("main",e)}function we(...e){return new n("nav",e)}function xe(...e){return new n("section",e)}function me(...e){return new n("blockquote",e)}function ye(...e){return new n("dd",e)}function ge(...e){return new n("div",e)}function Te(...e){return new n("dl",e)}function _e(...e){return new n("dt",e)}function be(...e){return new n("figcaption",e)}function ve(...e){return new n("figure",e)}function Ee(...e){return new n("hr",e)}function Me(...e){return new n("li",e)}function ke(...e){return new n("menu",e)}function Le(...e){return new n("ol",e)}function Se(...e){return new n("p",e)}function Ne(...e){return new n("pre",e)}function He(...e){return new n("ul",e)}function Ke(...e){return new n("a",e)}function Ce(...e){return new n("abbr",e)}function De(...e){return new n("b",e)}function je(...e){return new n("bdi",e)}function Ae(...e){return new n("bdo",e)}function qe(...e){return new n("br",e)}function Ve(...e){return new n("cite",e)}function Fe(...e){return new n("code",e)}function Pe(...e){return new n("data",e)}function We(...e){return new n("dfn",e)}function Oe(...e){return new n("em",e)}function Be(...e){return new n("i",e)}function Ge(...e){return new n("kbd",e)}function Ie(...e){return new n("mark",e)}function Re(...e){return new n("q",e)}function Ue(...e){return new n("rp",e)}function ze(...e){return new n("rt",e)}function Je(...e){return new n("ruby",e)}function Qe(...e){return new n("s",e)}function Xe(...e){return new n("samp",e)}function Ye(...e){return new n("small",e)}function Ze(...e){return new n("span",e)}function $e(...e){return new n("strong",e)}function en(...e){return new n("sub",e)}function nn(...e){return new n("sup",e)}function tn(...e){return new n("time",e)}function rn(...e){return new n("u",e)}function on(...e){return new n("var",e)}function cn(...e){return new n("wbr",e)}function ln(...e){return new n("area",e)}function un(...e){return new n("audio",e)}function sn(...e){return new n("img",e)}function dn(...e){return new n("map",e)}function hn(...e){return new n("track",e)}function an(...e){return new n("video",e)}function fn(...e){return new n("embed",e)}function pn(...e){return new n("iframe",e)}function wn(...e){return new n("object",e)}function xn(...e){return new n("picture",e)}function mn(...e){return new n("source",e)}function yn(...e){return new n("canvas",e)}function gn(...e){return new n("ins",e)}function Tn(...e){return new n("del",e)}function _n(...e){return new n("caption",e)}function bn(...e){return new n("col",e)}function vn(...e){return new n("colgroup",e)}function En(...e){return new n("table",e)}function Mn(...e){return new n("tbody",e)}function kn(...e){return new n("td",e)}function Ln(...e){return new n("tfoot",e)}function Sn(...e){return new n("th",e)}function Nn(...e){return new n("thead",e)}function Hn(...e){return new n("tr",e)}function Kn(...e){return new n("button",e)}function Cn(...e){return new n("datalist",e)}function Dn(...e){return new n("fieldset",e)}function jn(...e){return new n("form",e)}function An(...e){return new n("input",e)}function qn(...e){return new n("label",e)}function Vn(...e){return new n("legend",e)}function Fn(...e){return new n("meter",e)}function Pn(...e){return new n("optgroup",e)}function Wn(...e){return new n("option",e)}function On(...e){return new n("output",e)}function Bn(...e){return new n("progress",e)}function Gn(...e){return new n("select",e)}function In(...e){return new n("textarea",e)}function Rn(...e){return new n("details",e)}function Un(...e){return new n("dialog",e)}function zn(...e){return new n("summary",e)}function Jn(...e){return new n("slot",e)}function Qn(...e){return new n("template",e)}export{ee as ForEach,ne as ForIn,on as Var,Ke as a,Ce as abbr,re as address,ln as area,oe as article,ie as aside,un as audio,De as b,je as bdi,Ae as bdo,me as blockquote,qe as br,Kn as button,yn as canvas,_n as caption,Ve as cite,Fe as code,bn as col,vn as colgroup,Pe as data,Cn as datalist,ye as dd,Tn as del,Rn as details,We as dfn,Un as dialog,ge as div,Te as dl,_e as dt,te as dynNode,Oe as em,fn as embed,Dn as fieldset,be as figcaption,ve as figure,ce as footer,jn as form,$ as h,ue as h1,se as h2,de as h3,he as h4,ae as h5,fe as h6,le as header,Ee as hr,Be as i,pn as iframe,sn as img,An as input,gn as ins,Ge as kbd,qn as label,Vn as legend,Me as li,pe as main,dn as map,Ie as mark,ke as menu,Fn as meter,we as nav,wn as object,Le as ol,Pn as optgroup,Wn as option,On as output,Se as p,xn as picture,Ne as pre,Bn as progress,Re as q,_ as root,Ue as rp,ze as rt,Je as ruby,Qe as s,Xe as samp,xe as section,Gn as select,Jn as slot,Ye as small,mn as source,Ze as span,$e as strong,en as sub,zn as summary,nn as sup,En as table,Mn as tbody,kn as td,Qn as template,In as textarea,Ln as tfoot,Sn as th,Nn as thead,tn as time,Hn as tr,hn as track,rn as u,He as ul,an as video,cn as wbr};
//# sourceMappingURL=index.js.map
