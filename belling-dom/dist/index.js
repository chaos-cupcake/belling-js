var F=e=>{throw TypeError(e)};var U=(e,n,r)=>n.has(e)||F("Cannot "+r);var w=(e,n,r)=>(U(e,n,"read from private field"),r?r.call(e):n.get(e)),_=(e,n,r)=>n.has(e)?F("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(e):n.set(e,r);import{compute as p,State as C,Compute as D,Watcher as z,watcher as G,state as J}from"belling";var t=class{constructor(n,r){this.name=n,this.children=r}style(n){return this._style?Object.assign(this._style,n):this._style=n,this}styles(...n){let r=this._style||{};for(let c of n)Object.assign(r,c);return this._style=r,this}attr(n){return this._attr?Object.assign(this._attr,n):this._attr=n,this}on(n){return this._events?Object.assign(this._events,n):this._events=n,this}ref(n){return this._ref=n,this}render(n,r=document.createElement(this.name)){var o;let c=r;if(this.dom=c,this._events)for(let u in this._events){let i=this._events[u];u==="unmount"?n._addDestroyCallback(i):c.addEventListener(u,i)}if(this._attr)for(let u in this._attr){let i=this._attr[u];typeof i=="function"?n._watch(p(()=>{c.setAttribute(u,i())})):i instanceof D||i instanceof C?n._watch(p(()=>{c.setAttribute(u,i.v)})):c.setAttribute(u,i)}if(this._style)for(let u in this._style){let i=u,l=this._style[i];typeof l=="function"?n._watch(p(()=>{c.style[i]=l()})):l instanceof D||l instanceof C?n._watch(p(()=>{c.style[i]=l.v})):c.style[i]=l}if(this.children)for(let u of this.children)if(typeof u=="string"){let i=document.createTextNode(u);c.appendChild(i)}else if(typeof u=="function"){let i=document.createTextNode("");n._watch(p(()=>{i.nodeValue=u()})),c.appendChild(i)}else if(u instanceof C||u instanceof D){let i=document.createTextNode("");n._watch(p(()=>{i.nodeValue=u.v})),c.appendChild(i)}else c.appendChild(u.render(n));return(o=this._ref)==null||o.call(this,c),c}},j=new Set,q=new Set,V=!1;function Q(){q.forEach(e=>e()),j.forEach(e=>e.v),j.clear(),q.clear(),V=!1}function W(e){V||(V=!0,requestAnimationFrame(Q)),typeof e=="function"?q.add(e):j.add(e)}var y,k,v=class{constructor(n,r){_(this,y,new z);_(this,k,[]);this._whenDestroy=[];w(this,y).callback=W,this.dom=r.render(this),n==null||n.appendChild(this.dom)}_watch(n){w(this,k).push(n),w(this,y).watch(n)}_addDestroyCallback(n){this._whenDestroy.push(n)}_destroy(){w(this,y).unwatch(),this._whenDestroy.forEach(n=>n())}};y=new WeakMap,k=new WeakMap;function X(e,n,r){if(r.length=0,n.length=0,e.length<1)return r;function c(l,d){for(let h=n.length;h<l;h++)n.push(-1);n[l]=d}let o=0,u=e.length;for(;o<u&&e[o]==-1;o++);for(r[0]=o;o<u;o++){let l=e[o];if(l==-1)continue;let d=r[r.length-1];if(e[d]<l){c(o,d),r.push(o);continue}let h=0,m=r.length-1,x;for(;h<m;)x=h+m>>1,e[r[x]]<l?h=x+1:m=x;let a=h;l<e[r[a]]&&(a>0&&c(o,r[a-1]),r[a]=o)}o=r.length;let i=r[r.length-1];if(i>e.length)return r;for(;o-- >0;)r[o]=e[i],i=n[i];return r}var P=[],I=[],O=[],B=[],S,T,E=class extends t{constructor(r,c,o){super(r);_(this,S,new Map);_(this,T,new Map);this.list=c,this.f=o}render(r,c){let o=super.render(r,c),u=this.list,i=w(this,S),l=this.f,d=w(this,T),h=[];function m(){let a=P;a.length=0;let N=u.v;N.forEach(s=>{let f=i.get(s);typeof f=="number"?(i.set(s,-1),a.push(f)):a.push(-1)});let g=B;o.childNodes.forEach(s=>g.push(s)),h.forEach(s=>{s._destroy(),o.removeChild(s.dom)}),h.length=0,i.forEach((s,f)=>{s!=-1&&(d.get(f)._destroy(),d.delete(f),i.delete(f),o.removeChild(g[s]))});let R=X(a,I,O),A=0;N.forEach((s,f)=>{let H=a[f],K=R[A];if(H==-1){let b=new v(void 0,l(s));if(f==N.length-1?o.appendChild(b.dom):o.insertBefore(b.dom,g[K]),i.has(s)){h.push(b);return}d.set(s,b)}else H==K?A++:o.insertBefore(g[H],g[K]);i.set(s,f)}),P.length=I.length=O.length=B.length=0}let x=G(()=>{W(m)});return x.watch(u),r._addDestroyCallback(()=>{x.unwatch(),w(this,T).forEach(a=>a._destroy())}),m(),o}};S=new WeakMap,T=new WeakMap;var M=class extends t{constructor(r){super("div");this.dom=void 0;this._node=r;let c=()=>{var u;let o=r.v;if(this._ele=o,this._events=o._events,this._attr=o._attr,this._style=o._style,this._ref=o._ref,this.children=o.children,(u=this._root)==null||u._destroy(),this._root=new v(void 0,o),this.dynDom){let i=this.dynDom.parentNode;i&&i.replaceChild(this._root.dom,this.dynDom)}this.dynDom=o.dom};this._watcher=G(c)}render(r){let c=this._node;return this._ele=c.v,this._watcher.watch(c),this._watcher.callback(),r._addDestroyCallback(()=>{var o;(o=this._root)==null||o._destroy(),this._watcher.unwatch()}),this.dynDom}};function te(e,...n){return new t(e,n)}function ne(e,n,r){return new E(e,n,r)}function re(e,n,r){let c=new WeakMap;return new E(e,p(()=>{let u=n.v;return u.forEach((i,l)=>{let d=c.get(i);d?d.v=l:c.set(i,J(l))}),u}),u=>r(c.get(u),u))}function oe(e){return typeof e=="function"?new M(p(e)):new M(e)}var L=class extends t{constructor(n){super(n)}bind(n){return this.value=n,this}render(n,r){let c=super.render(n,r);return this.value&&(n._watch(p(()=>{c.value=this.value.v})),c.addEventListener("input",()=>{this.value.v=c.value})),c}};function ie(...e){return new t("address",e)}function ce(...e){return new t("article",e)}function ue(...e){return new t("aside",e)}function le(...e){return new t("footer",e)}function se(...e){return new t("header",e)}function ae(...e){return new t("h1",e)}function de(...e){return new t("h2",e)}function he(...e){return new t("h3",e)}function fe(...e){return new t("h4",e)}function pe(...e){return new t("h5",e)}function we(...e){return new t("h6",e)}function xe(...e){return new t("main",e)}function me(...e){return new t("nav",e)}function ye(...e){return new t("section",e)}function ge(...e){return new t("blockquote",e)}function _e(...e){return new t("dd",e)}function Te(...e){return new t("div",e)}function be(...e){return new t("dl",e)}function ve(...e){return new t("dt",e)}function Ee(...e){return new t("figcaption",e)}function Me(...e){return new t("figure",e)}function Le(){return new t("hr")}function ke(...e){return new t("li",e)}function Se(...e){return new t("menu",e)}function Ne(...e){return new t("ol",e)}function He(...e){return new t("p",e)}function Ke(...e){return new t("pre",e)}function Ce(...e){return new t("ul",e)}function De(...e){return new t("a",e)}function je(...e){return new t("abbr",e)}function qe(...e){return new t("b",e)}function Ve(...e){return new t("bdi",e)}function Ae(...e){return new t("bdo",e)}function Fe(){return new t("br")}function Pe(...e){return new t("cite",e)}function Ie(...e){return new t("code",e)}function Oe(...e){return new t("data",e)}function Be(...e){return new t("dfn",e)}function Ge(...e){return new t("em",e)}function We(...e){return new t("i",e)}function Re(...e){return new t("kbd",e)}function Ue(...e){return new t("mark",e)}function ze(...e){return new t("q",e)}function Je(...e){return new t("rp",e)}function Qe(...e){return new t("rt",e)}function Xe(...e){return new t("ruby",e)}function Ye(...e){return new t("s",e)}function Ze(...e){return new t("samp",e)}function $e(...e){return new t("small",e)}function et(...e){return new t("span",e)}function tt(...e){return new t("strong",e)}function nt(...e){return new t("sub",e)}function rt(...e){return new t("sup",e)}function ot(...e){return new t("time",e)}function it(...e){return new t("u",e)}function ct(...e){return new t("var",e)}function ut(){return new t("wbr")}function lt(){return new t("area")}function st(...e){return new t("audio",e)}function at(){return new t("img")}function dt(...e){return new t("map",e)}function ht(){return new t("track")}function ft(...e){return new t("video",e)}function pt(){return new t("embed")}function wt(...e){return new t("iframe",e)}function xt(...e){return new t("object",e)}function mt(...e){return new t("picture",e)}function yt(){return new t("source")}function gt(...e){return new t("canvas",e)}function _t(...e){return new t("ins",e)}function Tt(...e){return new t("del",e)}function bt(...e){return new t("caption",e)}function vt(){return new t("col")}function Et(...e){return new t("colgroup",e)}function Mt(...e){return new t("table",e)}function Lt(...e){return new t("tbody",e)}function kt(...e){return new t("td",e)}function St(...e){return new t("tfoot",e)}function Nt(...e){return new t("th",e)}function Ht(...e){return new t("thead",e)}function Kt(...e){return new t("tr",e)}function Ct(...e){return new t("button",e)}function Dt(...e){return new t("datalist",e)}function jt(...e){return new t("fieldset",e)}function qt(...e){return new t("form",e)}function Vt(){return new L("input")}function At(...e){return new t("label",e)}function Ft(...e){return new t("legend",e)}function Pt(...e){return new t("meter",e)}function It(...e){return new t("optgroup",e)}function Ot(...e){return new t("option",e)}function Bt(...e){return new t("output",e)}function Gt(...e){return new t("progress",e)}function Wt(...e){return new t("select",e)}function Rt(){return new L("textarea")}function Ut(...e){return new t("details",e)}function zt(...e){return new t("dialog",e)}function Jt(...e){return new t("summary",e)}function Qt(...e){return new t("slot",e)}function Xt(...e){return new t("template",e)}export{ne as ForEach,re as ForIn,ct as Var,De as a,je as abbr,ie as address,lt as area,ce as article,ue as aside,st as audio,qe as b,Ve as bdi,Ae as bdo,ge as blockquote,Fe as br,Ct as button,gt as canvas,bt as caption,Pe as cite,Ie as code,vt as col,Et as colgroup,Oe as data,Dt as datalist,_e as dd,Tt as del,Ut as details,Be as dfn,zt as dialog,Te as div,be as dl,ve as dt,oe as dynNode,Ge as em,pt as embed,jt as fieldset,Ee as figcaption,Me as figure,le as footer,qt as form,te as h,ae as h1,de as h2,he as h3,fe as h4,pe as h5,we as h6,se as header,Le as hr,We as i,wt as iframe,at as img,Vt as input,_t as ins,Re as kbd,At as label,Ft as legend,ke as li,xe as main,dt as map,Ue as mark,Se as menu,Pt as meter,me as nav,xt as object,Ne as ol,It as optgroup,Ot as option,Bt as output,He as p,mt as picture,Ke as pre,Gt as progress,ze as q,v as root,Je as rp,Qe as rt,Xe as ruby,Ye as s,Ze as samp,ye as section,Wt as select,Qt as slot,$e as small,yt as source,et as span,tt as strong,nt as sub,Jt as summary,rt as sup,Mt as table,Lt as tbody,kt as td,Xt as template,Rt as textarea,St as tfoot,Nt as th,Ht as thead,ot as time,Kt as tr,ht as track,it as u,Ce as ul,ft as video,ut as wbr};
//# sourceMappingURL=index.js.map
