var V=e=>{throw TypeError(e)};var R=(e,n,r)=>n.has(e)||V("Cannot "+r);var w=(e,n,r)=>(R(e,n,"read from private field"),r?r.call(e):n.get(e)),T=(e,n,r)=>n.has(e)?V("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(e):n.set(e,r);import{compute as x,State as H,Compute as C,Watcher as W,watcher as O,state as U}from"belling";var t=class{constructor(n,r){this.name=n,this.children=r}style(n){return this._style?Object.assign(this._style,n):this._style=n,this}attr(n){return this._attr?Object.assign(this._attr,n):this._attr=n,this}on(n){return this._events?Object.assign(this._events,n):this._events=n,this}ref(n){return this._ref=n,this}render(n,r=document.createElement(this.name)){var c;let i=r;if(this.dom=i,this._events)for(let o in this._events){let u=this._events[o];o==="unmount"?n._addDestroyCallback(u):i.addEventListener(o,u)}if(this._attr)for(let o in this._attr){let u=this._attr[o];typeof u=="function"?n._watch(x(()=>{i.setAttribute(o,u())})):u instanceof C||u instanceof H?n._watch(x(()=>{i.setAttribute(o,u.v)})):i.setAttribute(o,u)}if(this._style)for(let o in this._style){let u=o,l=this._style[u];typeof l=="function"?n._watch(x(()=>{i.style[u]=l()})):l instanceof C||l instanceof H?n._watch(x(()=>{i.style[u]=l.v})):i.style[u]=l}if(this.children)for(let o of this.children)if(typeof o=="string"){let u=document.createTextNode(o);i.appendChild(u)}else if(typeof o=="function"){let u=document.createTextNode("");n._watch(x(()=>u.nodeValue=o())),i.appendChild(u)}else if(o instanceof H||o instanceof C){let u=document.createTextNode("");n._watch(x(()=>u.nodeValue=o.v)),i.appendChild(u)}else i.appendChild(o.render(n));return(c=this._ref)==null||c.call(this,i),i}},K=new Set,D=new Set,j=!1;function z(){D.forEach(e=>e()),K.forEach(e=>e.v),K.clear(),D.clear(),j=!1}function B(e){j||(j=!0,requestAnimationFrame(z)),typeof e=="function"?D.add(e):K.add(e)}var y,M,v=class{constructor(n,r){T(this,y,new W);T(this,M,[]);this._whenDestroy=[];w(this,y).callback=B,this.dom=r.render(this),n==null||n.appendChild(this.dom)}_watch(n){w(this,M).push(n),w(this,y).watch(n)}_addDestroyCallback(n){this._whenDestroy.push(n)}_destroy(){w(this,y).unwatch(),this._whenDestroy.forEach(n=>n())}};y=new WeakMap,M=new WeakMap;function J(e,n,r){if(r.length=0,n.length=0,e.length<1)return r;function i(l,a){for(let h=n.length;h<l;h++)n.push(-1);n[l]=a}let c=0,o=e.length;for(;c<o&&e[c]==-1;c++);for(r[0]=c;c<o;c++){let l=e[c];if(l==-1)continue;let a=r[r.length-1];if(e[a]<l){i(c,a),r.push(c);continue}let h=0,m=r.length-1,d;for(;h<m;)d=h+m>>1,e[r[d]]<l?h=d+1:m=d;let p=h;l<e[r[p]]&&(p>0&&i(c,r[p-1]),r[p]=c)}c=r.length;let u=r[r.length-1];if(u>e.length)return r;for(;c-- >0;)r[c]=e[u],u=n[u];return r}var F=[],P=[],A=[],I=[],L,_,E=class extends t{constructor(r,i,c){super(r);T(this,L,new Map);T(this,_,new Map);this.list=i,this.f=c}render(r){let i=super.render(r),c=this.list,o=w(this,L),u=this.f,l=w(this,_),a=[];function h(){let d=F;d.length=0;let p=c.v;p.forEach(s=>{let f=o.get(s);typeof f=="number"?(o.set(s,-1),d.push(f)):d.push(-1)});let g=I;i.childNodes.forEach(s=>g.push(s)),a.forEach(s=>{s._destroy(),i.removeChild(s.dom)}),a.length=0,o.forEach((s,f)=>{s!=-1&&(l.get(f)._destroy(),l.delete(f),o.delete(f),i.removeChild(g[s]))});let G=J(d,P,A),q=0;p.forEach((s,f)=>{let S=d[f],N=G[q];if(S==-1){let b=new v(void 0,u(s));if(f==p.length-1?i.appendChild(b.dom):i.insertBefore(b.dom,g[N]),o.has(s)){a.push(b);return}l.set(s,b)}else S==N?q++:i.insertBefore(g[S],g[N]);o.set(s,f)}),F.length=P.length=A.length=I.length=0}let m=O(()=>{B(h)});return m.watch(c),r._addDestroyCallback(()=>{m.unwatch(),w(this,_).forEach(d=>d._destroy())}),h(),i}};L=new WeakMap,_=new WeakMap;var k=class extends t{constructor(r){super("div");this.dom=void 0;this._node=r;let i=()=>{var o;let c=r.v;if(this._ele=c,this._events=c._events,this._attr=c._attr,this._style=c._style,this._ref=c._ref,this.children=c.children,(o=this._root)==null||o._destroy(),this._root=new v(void 0,c),this.dynDom){let u=this.dynDom.parentNode;u&&u.replaceChild(this._root.dom,this.dynDom)}this.dynDom=c.dom};this._watcher=O(i)}render(r){let i=this._node;return this._ele=i.v,this._watcher.watch(i),this._watcher.callback(),r._addDestroyCallback(()=>{var c;(c=this._root)==null||c._destroy(),this._watcher.unwatch()}),this.dynDom}};function $(e,...n){return new t(e,n)}function ee(e,n,r){return new E(e,n,r)}function te(e,n,r){let i=new WeakMap;return new E(e,x(()=>{let o=n.v;return o.forEach((u,l)=>{let a=i.get(u);a?a.v=l:i.set(u,U(l))}),o}),o=>r(i.get(o),o))}function ne(e){return typeof e=="function"?new k(x(e)):new k(e)}function re(...e){return new t("address",e)}function oe(...e){return new t("article",e)}function ie(...e){return new t("aside",e)}function ce(...e){return new t("footer",e)}function ue(...e){return new t("header",e)}function le(...e){return new t("h1",e)}function se(...e){return new t("h2",e)}function de(...e){return new t("h3",e)}function ae(...e){return new t("h4",e)}function he(...e){return new t("h5",e)}function fe(...e){return new t("h6",e)}function pe(...e){return new t("main",e)}function we(...e){return new t("nav",e)}function xe(...e){return new t("section",e)}function me(...e){return new t("blockquote",e)}function ye(...e){return new t("dd",e)}function ge(...e){return new t("div",e)}function Te(...e){return new t("dl",e)}function _e(...e){return new t("dt",e)}function be(...e){return new t("figcaption",e)}function ve(...e){return new t("figure",e)}function Ee(){return new t("hr")}function ke(...e){return new t("li",e)}function Me(...e){return new t("menu",e)}function Le(...e){return new t("ol",e)}function Se(...e){return new t("p",e)}function Ne(...e){return new t("pre",e)}function He(...e){return new t("ul",e)}function Ce(...e){return new t("a",e)}function Ke(...e){return new t("abbr",e)}function De(...e){return new t("b",e)}function je(...e){return new t("bdi",e)}function qe(...e){return new t("bdo",e)}function Ve(){return new t("br")}function Fe(...e){return new t("cite",e)}function Pe(...e){return new t("code",e)}function Ae(...e){return new t("data",e)}function Ie(...e){return new t("dfn",e)}function Oe(...e){return new t("em",e)}function Be(...e){return new t("i",e)}function Ge(...e){return new t("kbd",e)}function Re(...e){return new t("mark",e)}function We(...e){return new t("q",e)}function Ue(...e){return new t("rp",e)}function ze(...e){return new t("rt",e)}function Je(...e){return new t("ruby",e)}function Qe(...e){return new t("s",e)}function Xe(...e){return new t("samp",e)}function Ye(...e){return new t("small",e)}function Ze(...e){return new t("span",e)}function $e(...e){return new t("strong",e)}function et(...e){return new t("sub",e)}function tt(...e){return new t("sup",e)}function nt(...e){return new t("time",e)}function rt(...e){return new t("u",e)}function ot(...e){return new t("var",e)}function it(){return new t("wbr")}function ct(){return new t("area")}function ut(...e){return new t("audio",e)}function lt(){return new t("img")}function st(...e){return new t("map",e)}function dt(){return new t("track")}function at(...e){return new t("video",e)}function ht(){return new t("embed")}function ft(...e){return new t("iframe",e)}function pt(...e){return new t("object",e)}function wt(...e){return new t("picture",e)}function xt(){return new t("source")}function mt(...e){return new t("canvas",e)}function yt(...e){return new t("ins",e)}function gt(...e){return new t("del",e)}function Tt(...e){return new t("caption",e)}function _t(){return new t("col")}function bt(...e){return new t("colgroup",e)}function vt(...e){return new t("table",e)}function Et(...e){return new t("tbody",e)}function kt(...e){return new t("td",e)}function Mt(...e){return new t("tfoot",e)}function Lt(...e){return new t("th",e)}function St(...e){return new t("thead",e)}function Nt(...e){return new t("tr",e)}function Ht(...e){return new t("button",e)}function Ct(...e){return new t("datalist",e)}function Kt(...e){return new t("fieldset",e)}function Dt(...e){return new t("form",e)}function jt(){return new t("input")}function qt(...e){return new t("label",e)}function Vt(...e){return new t("legend",e)}function Ft(...e){return new t("meter",e)}function Pt(...e){return new t("optgroup",e)}function At(...e){return new t("option",e)}function It(...e){return new t("output",e)}function Ot(...e){return new t("progress",e)}function Bt(...e){return new t("select",e)}function Gt(...e){return new t("textarea",e)}function Rt(...e){return new t("details",e)}function Wt(...e){return new t("dialog",e)}function Ut(...e){return new t("summary",e)}function zt(...e){return new t("slot",e)}function Jt(...e){return new t("template",e)}export{ee as ForEach,te as ForIn,ot as Var,Ce as a,Ke as abbr,re as address,ct as area,oe as article,ie as aside,ut as audio,De as b,je as bdi,qe as bdo,me as blockquote,Ve as br,Ht as button,mt as canvas,Tt as caption,Fe as cite,Pe as code,_t as col,bt as colgroup,Ae as data,Ct as datalist,ye as dd,gt as del,Rt as details,Ie as dfn,Wt as dialog,ge as div,Te as dl,_e as dt,ne as dynNode,Oe as em,ht as embed,Kt as fieldset,be as figcaption,ve as figure,ce as footer,Dt as form,$ as h,le as h1,se as h2,de as h3,ae as h4,he as h5,fe as h6,ue as header,Ee as hr,Be as i,ft as iframe,lt as img,jt as input,yt as ins,Ge as kbd,qt as label,Vt as legend,ke as li,pe as main,st as map,Re as mark,Me as menu,Ft as meter,we as nav,pt as object,Le as ol,Pt as optgroup,At as option,It as output,Se as p,wt as picture,Ne as pre,Ot as progress,We as q,v as root,Ue as rp,ze as rt,Je as ruby,Qe as s,Xe as samp,xe as section,Bt as select,zt as slot,Ye as small,xt as source,Ze as span,$e as strong,et as sub,Ut as summary,tt as sup,vt as table,Et as tbody,kt as td,Jt as template,Gt as textarea,Mt as tfoot,Lt as th,St as thead,nt as time,Nt as tr,dt as track,rt as u,He as ul,at as video,it as wbr};
//# sourceMappingURL=index.js.map
